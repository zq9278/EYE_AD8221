#
# Copyright (c) 2018 Nordic Semiconductor
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_DEVICE_NAME="EYE_AD8221"
CONFIG_BT_SMP=n
CONFIG_BT_SETTINGS=n
CONFIG_BT_LBS_SECURITY_ENABLED=n

# Keep the connection interval from being auto-changed to slow defaults.
CONFIG_BT_GAP_AUTO_UPDATE_CONN_PARAMS=n
CONFIG_BT_GAP_PERIPHERAL_PREF_PARAMS=y
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=6
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=12
CONFIG_BT_PERIPHERAL_PREF_LATENCY=0
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=400

# SAADC via NRFX (timer + PPI driven)
CONFIG_ADC=n
CONFIG_NRFX_SAADC=y
CONFIG_NRFX_TIMER2=y
CONFIG_NRFX_PPI=y

# BLE peripheral helpers
CONFIG_DK_LIBRARY=y

CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=1024
CONFIG_ISR_STACK_SIZE=1536

# UART (P0.06 TX / P0.12 RX via overlay) used for VOFA+ binary stream
CONFIG_SERIAL=y
CONFIG_NRFX_UARTE0=y

# Streaming + filtering (defaults)
CONFIG_EYE_BLE_STREAM_HZ=4000
CONFIG_EYE_BLE_PACKET_HZ=100
CONFIG_EYE_BLE_STREAM_DISABLED=n
CONFIG_EYE_ADC_SAMPLE_RATE_HZ=4000
CONFIG_EYE_NOTCH_FREQ_HZ=50
CONFIG_EYE_NOTCH_ENABLED=y
CONFIG_EYE_NOTCH_Q=25
CONFIG_EYE_NOTCH_DOUBLE=y
CONFIG_EYE_ENVELOPE_ENABLED=y
CONFIG_EYE_ENVELOPE_TAU_SHIFT=5
CONFIG_EYE_BLE_CONN_INTERVAL_MIN=6
CONFIG_EYE_BLE_CONN_INTERVAL_MAX=12

# VOFA+ UART stream (raw ADC + filtered sample)
CONFIG_EYE_UART_STREAM=y
CONFIG_EYE_UART_STREAM_CENTERED=n
CONFIG_EYE_UART_STREAM_HZ=2000
CONFIG_EYE_UART_STREAM_CHANNELS=3

# Keep UART clean for VOFA+ binary stream: route text output to RTT instead.
CONFIG_USE_SEGGER_RTT=y
CONFIG_RTT_CONSOLE=y
CONFIG_SEGGER_RTT_BUFFER_SIZE_UP=512
CONFIG_SEGGER_RTT_MAX_NUM_UP_BUFFERS=4
CONFIG_SEGGER_RTT_MAX_NUM_DOWN_BUFFERS=1
CONFIG_CONSOLE=y
CONFIG_PRINTK=y
CONFIG_UART_CONSOLE=n
CONFIG_BOOT_BANNER=n

# Increase TX capacity to sustain high notification rates even if the central
# selects a longer connection interval.
CONFIG_BT_CONN_TX_MAX=6
CONFIG_BT_L2CAP_TX_BUF_COUNT=6
CONFIG_BT_ATT_TX_COUNT=6
CONFIG_BT_BUF_ACL_TX_COUNT=6
CONFIG_BT_BUF_EVT_RX_COUNT=8

# Debug: crash visibility and assertions
CONFIG_FAULT_DUMP=2
CONFIG_ASSERT=y
CONFIG_DEBUG_OPTIMIZATIONS=y
CONFIG_RESET_ON_FATAL_ERROR=n
CONFIG_THREAD_STACK_INFO=y
CONFIG_STACK_SENTINEL=n
